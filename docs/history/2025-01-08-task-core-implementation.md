# タスク管理コアロジック実装

日付: 2025-01-08

## 概要

Taskellプロジェクトの中核となるタスク管理ロジックを`src/shared/core`に実装しました。ヘッドレスアーキテクチャに基づき、UI層から独立したビジネスロジックを作成しました。

## 実装内容

### 1. データ構造の定義 (types.ts)

- **Task**: タスクの基本構造（ID、内容、ステータス、作成日時、更新日時）
- **TaskMeta**: タスクのメタデータ（期限、タグ、メモ）
- **TaskDue**: 期限情報（実施目安日、締め切り）
- **TaskSet**: タスクの集合（プロジェクト内のサブカテゴリ）
- **Project**: プロジェクト（複数のタスクセットを含む）
- **TaskSetSchedule**: スケジュール情報（単発・繰り返し設定）
- **TaskHistory**: タスク履歴（アクション、タイムスタンプ、変更内容）

### 2. 各機能モジュール

#### task.ts
- タスクの作成、開始、完了、更新
- ステータス別のタスク取得
- タスクメタデータの管理
- 期限切れチェック

#### taskset.ts
- タスクセットの作成（タスク付き）
- タスクの追加・削除・更新
- 進捗状況の計算
- アクティブタスクの取得

#### project.ts
- プロジェクトの作成
- タスクセットの管理
- アーカイブ機能
- プロジェクト全体の進捗管理

#### schedule.ts
- スケジュールの作成（単発・繰り返し）
- 日付ごとのスケジュール取得
- 今後のスケジュール一覧
- 次回実施日の計算

#### history.ts
- タスク履歴の記録
- アクション別の履歴作成
- 履歴の検索・フィルタリング
- 履歴の整形表示

#### storage.ts
- JSON形式でのデータ永続化
- `~/.config/taskell/data.json`への保存
- バックアップ・リストア機能
- インポート・エクスポート機能
- DataManagerクラスによる統合管理

### 3. デモスクリプト (demo.ts)

実装したロジックの動作確認用デモを作成し、以下の機能を確認：
- プロジェクトとタスクセットの作成
- タスクの進行（開始→完了）
- スケジュールの登録
- 進捗状況の表示
- データの永続化

## 発見された課題

デモ実行により以下の課題が明らかになりました：

1. **タスクの並び替え機能がない** - 優先順位や期限での並び替えが必要
2. **タスクセット間でタスクを移動できない** - タスクの再分類機能
3. **タスクの検索機能がない** - キーワード検索、フィルタリング
4. **タスクの履歴管理がない** - 変更履歴の追跡（※実装済み）
5. **複数ユーザーでの同時編集に対応していない** - ロック機構、競合解決
6. **タスクの見積もり時間と実績時間の管理がない** - 時間追跡機能
7. **タスクのタグやカテゴリによるフィルタリングがない** - より柔軟な分類
8. **通知機能がない** - 期限通知、スケジュールリマインダー
9. **タスクテンプレート機能がない** - 定型タスクの再利用
10. **外部カレンダーとの連携機能がない** - iCal形式でのエクスポートなど

## 技術的な考慮事項

- TypeScriptの型定義により型安全性を確保
- 純粋関数を中心とした実装でテストしやすい構造
- イミュータブルなデータ更新パターンの採用
- エラーハンドリング（不正な状態遷移の防止）

## 次のステップ

1. CLIツールの実装（Deno使用）
2. MCP Serverの実装
3. 上記課題の優先順位付けと段階的な実装
4. パフォーマンスの最適化（大量タスク対応）
5. より高度なスケジューリング機能の追加

思った感じになってないので整理する．
