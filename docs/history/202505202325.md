# タスクは状態変化

https://chatgpt.com/share/682ca111-1770-8003-9a8b-70f13cd0021d

考えないといけないことがいくつかあって，
- タスクとは何か
- コンセプトを達成するためのコア機能は何か
- AIによって効果をどう最大化できるか
- コア機能とAI機能の境界
- データ構造
- データフロー

という流れ

タスクは何等かの状態変化を伴う．

以下は、あなたとのこれまでの会話に基づいて、「タスク管理ツール開発における概念整理・設計方針」を体系的にまとめたものです。

---

## 🧭 1. 全体方針と設計プロセス

### 決定した設計プロセスの順序（抽象→具体）

1. **タスクとは何か**
2. **コンセプトと、それを実現するコア機能**
3. **AI による効果最大化の範囲と限界**
4. **コアと AI の設計境界（ホワイトリスト方式）**
5. **データ構造**
6. **データフロー**

---

## 📌 2. 決定された基礎概念

### ◆ タスクの定義

* **タスクとは「状態変化 ΔS を生み出す意思決定」である。**
* 外部に可視の成果がなくとも、「やらないと決める」などの判断もタスクとみなす。

### ◆ コンセプト

* **「行動に移れること」こそが、タスクの存在意義である。**
* よって ΔS（完了条件）が明記されていないものは「未確定」とし、実行対象に昇格しない。

---

## 🔧 3. コア機能とユーザーフロー

### ◆ ユーザーにとって必要な最小限の機能（AIなしで完結）

| 操作                           | 意図             | 例                                  |
| ---------------------------- | -------------- | ---------------------------------- |
| `task add "やること"`            | 雑モードで即記録       | → 状態：`Zatsu`                       |
| `task set-delta <id> "完了判定"` | ΔS 記述で Ready 化 | → 状態：`Ready`                       |
| `task start <id> -t 25`      | タイマー開始＋メモ記録    | → 状態：`Active`                      |
| `task done / pause / drop`   | 終了 or 中断 or 放棄 | → 状態：`Done` / `Paused` / `Dropped` |

### ◆ 状態遷移モデル（確定済）

```
Zatsu → Draft → Ready → Active → Done
                         ↘         ↘
                        Paused     Dropped
Draft や Active からも Dropped に遷移可能
```

---

## 🧠 4. AI-Assist の設計と境界

### ◆ 基本方針

* **AI は「提案」に限定され、コアは人間が確定させる。**
* オフライン／AI なしでもツールは完全に運用可能（Degradable）。

### ◆ ホワイトリスト（AI が書き込める項目）

| フィールド      | 機能                     |
| ---------- | ---------------------- |
| `delta`    | 完了判定の雛形生成              |
| `estimate` | 所要時間の予測                |
| `tags`     | 自動分類                   |
| `split[]`  | タスク分割候補（複数 title のリスト） |
| `dueDate`  | 締切推定（オプション）            |

---

## 🌐 5. MCP Server との関係性

* AI は **MCP Server の JSON-RPC クライアント**としてタスク管理ツールにアクセス。
* MCP Server 経由で実質的に AI-Assist を実装する。

### ◆ JSON-RPC メソッド設計（抜粋）

| メソッド                              | 説明           |
| --------------------------------- | ------------ |
| `task.add`                        | 新規登録（雑モード）   |
| `task.updateAllowed`              | ホワイトリスト項目の更新 |
| `task.split`                      | 分割提案（子タスク生成） |
| `task.proposeDelta`               | ΔS 提案（承認待ち）  |
| `proposal.list / accept / reject` | 人による提案レビュー   |

---

## ⏱ 6. タイマーとCLI設計

### CLI での集中実行フロー

```bash
$ task start 42 -t 25
> API エラーを調査中
> config.ts の typo 修正
^D
--- 25:00経過 ---
完了しましたか？ [y]/n/pause/drop:
```

* タイマー＋メモ＋状態遷移を CLI 上で一括操作可能。
* 記録されたメモはログに保存。後で振り返りに活用。

---

## ❓ 7. 検討中／今後決めるべき事項

| 項目                    | 内容                                |
| --------------------- | --------------------------------- |
| **AI-Assist 提案の承認UX** | CLI・TUI・GUI でどう見せるか               |
| **データ構造の最小スキーマ**      | `task`, `log`, `proposal` などの形式確定 |
| **MCP Server 認可制御**   | AI/人間ごとにメソッド制限をどうするか              |

---

## ✅ 現時点の結論まとめ（要点）

* タスク＝「状態を変える」こと。そのために ΔS 記述は不可欠。
* コア機能はオフラインで完結する。

---

これをベースに次に詰めるべきは、**提案承認フロー or MCP スキーマ or 状態ラベルの仕様確定**。
必要であれば各項目ごとの図解やスキーマ草案も出せます。次に進めたいところを教えてください。
